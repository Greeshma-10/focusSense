<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>FocusSense</title>
<style>
  body {
    margin: 0;
    font-family: "Segoe UI", sans-serif;
    background-color: #121212;
    color: white;
  }
  .popup-style {
    background-color: #1f1f1f;
    color: #fff;
    border-radius: 16px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.4);
    padding: 20px;
    width: 320px;
    margin: 50px auto;
  }
  .full-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .timer-display {
    font-size: 36px;
    font-weight: 600;
    color: #00e676;
    background-color: #121212;
    padding: 12px 20px;
    border-radius: 12px;
    min-width: 140px;
    text-align: center;
    margin: 10px auto;
    box-shadow: 0 4px 12px rgba(0,230,118,0.5);
    user-select: none;
  }
  .start-btn {
    background-color: #2196F3;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 14px;
    border-radius: 10px;
    cursor: pointer;
    width: 100%;
  }
  .start-btn:hover {
    background-color: #1976D2;
  }
  input[type="number"] {
    width: 60px;
    font-size: 18px;
    padding: 5px;
    border-radius: 8px;
    border: 1px solid #444;
  }
  h1{
    text-align: center;
  }
  h4{
    text-align: center;
    color: aliceblue;
  }
</style>
</head>
<body>
<h1> FOCUS SENSE</h1>
<h4>Real-Time Distraction Detector</h4>
<div class="popup-style">
  <div class="full-header">
    <h3 style="margin: 0;margin-left: 100px;">Focus Session</h3>
  </div>
  <div style="margin: 10px 0; text-align: center;">
    <input type="number" id="minutes" value="60" min="5" max="180" />
    <span style="font-size: 18px; margin-left: 8px;">mins</span>
  </div>
  <div id="timerDisplay" class="timer-display">⏱ 60:00</div>
  <button class="start-btn" id="startBtn" onclick="startFocusSession()">▶ Start focus session</button>
  <button class="start-btn" id="stopBtn" onclick="stopFocusSession()" style="margin-top: 5px;" disabled>⏹ Stop</button>
</div>

<script>
  let countdownInterval;
  let remainingTime = 0;

  function startFocusSession() {
    const minutesInput = document.getElementById('minutes');
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const timerDisplay = document.getElementById('timerDisplay');

    const minutes = parseInt(minutesInput.value);
    if (isNaN(minutes) || minutes < 1) {
      alert("Please enter a valid number of minutes.");
      return;
    }

    remainingTime = minutes * 60;
    clearInterval(countdownInterval);

    minutesInput.disabled = true;
    startBtn.disabled = true;
    stopBtn.disabled = false;
    startBtn.textContent = '⏳ Running...';

    fetch('/start'); // Optional, if you have backend

    function updateTimer() {
      const mins = Math.floor(remainingTime / 60);
      const secs = remainingTime % 60;
      timerDisplay.textContent = `⏱ ${mins}:${secs.toString().padStart(2,'0')}`;

      if (remainingTime <= 0) {
        clearInterval(countdownInterval);
        timerDisplay.textContent = "✅ Focus session complete!";
        resetControls();
        fetch('/stop');
      }
      remainingTime--;
    }

    updateTimer();
    countdownInterval = setInterval(updateTimer, 1000);
  }

  function stopFocusSession() {
    clearInterval(countdownInterval);

    const minutesInput = document.getElementById('minutes');
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const timerDisplay = document.getElementById('timerDisplay');

    timerDisplay.textContent = "▶ Start Focus Session";

    resetControls();
    fetch('/stop');
  }

  function resetControls() {
    document.getElementById('minutes').disabled = false;
    document.getElementById('startBtn').disabled = false;
    document.getElementById('stopBtn').disabled = true;
    document.getElementById('startBtn').textContent = '▶ Start focus session';
  }
</script>

</body>
</html>
